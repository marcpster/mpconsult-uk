---
import BaseLayout from '../layouts/BaseLayout.astro';
import ServiceCard from '../components/ServiceCard.astro';
import StatCard from '../components/StatCard.astro';
import site from '../data/site.json';
import homepage from '../data/homepage.json';
import { getCollection } from 'astro:content';

// Get services sorted by order
const services = (await getCollection('services')).sort((a, b) => a.data.order - b.data.order);
---

<BaseLayout>
  <!-- Hero Section -->
  <section class="py-20 md:py-32">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col md:flex-row md:items-center gap-8 md:gap-12">
        <img
          src="/avatar.png"
          alt="MP"
          class="w-24 h-24 md:w-32 md:h-32 rounded-full bg-neutral-200 dark:bg-neutral-800 flex-shrink-0"
          onerror="this.style.display='none'"
        />
        <div>
          <h1 class="text-neutral-900 dark:text-neutral-100 mb-4">
            {site.tagline}
          </h1>
          <p class="text-xl text-neutral-600 dark:text-neutral-400 mb-8">
            {homepage.hero.subheadline}
          </p>
          <a
            href={homepage.hero.cta.href}
            class="inline-flex items-center px-6 py-3 text-base font-medium rounded-lg bg-accent-600 text-white hover:bg-accent-700 transition-colors"
          >
            {homepage.hero.cta.label}
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Problem Section -->
  <section class="py-16 md:py-24 bg-neutral-100 dark:bg-neutral-900">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-neutral-900 dark:text-neutral-100 mb-8">
        {homepage.problems.heading}
      </h2>
      <ul class="grid md:grid-cols-2 gap-4 mb-8">
        {homepage.problems.items.map((item) => (
          <li class="flex items-start gap-3">
            <span class="text-accent-500 mt-1">—</span>
            <span class="text-neutral-700 dark:text-neutral-300">{item}</span>
          </li>
        ))}
      </ul>
      <p class="text-lg text-neutral-600 dark:text-neutral-400 max-w-2xl">
        {homepage.problems.closing}
      </p>
    </div>
  </section>

  <!-- Services Section -->
  <section class="py-16 md:py-24">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-neutral-900 dark:text-neutral-100 mb-8">
        {homepage.services.heading}
      </h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
        {services.map((service) => (
          <ServiceCard
            title={service.data.title}
            tagline={service.data.tagline}
            href={`/services/${service.id}`}
          />
        ))}
      </div>
      <div class="mt-8">
        <a
          href={homepage.services.cta.href}
          class="inline-flex items-center text-accent-600 dark:text-accent-400 font-medium hover:text-accent-700 dark:hover:text-accent-300"
        >
          {homepage.services.cta.label}
          <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Proof Section -->
  <section class="py-16 md:py-24 bg-neutral-100 dark:bg-neutral-900">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-neutral-900 dark:text-neutral-100 mb-12 text-center">
        {homepage.proof.heading}
      </h2>
      <div class="grid md:grid-cols-3 gap-8 mb-12">
        {homepage.proof.stats.map((stat) => (
          <StatCard value={stat.value} label={stat.label} />
        ))}
      </div>
      {homepage.proof.testimonial && (
        <blockquote class="max-w-2xl mx-auto py-8 px-8 border-l-4 border-accent-500 bg-white dark:bg-neutral-800 rounded-r-xl">
          <p class="text-xl md:text-2xl font-medium text-neutral-800 dark:text-neutral-200 leading-relaxed mb-4">
            "{homepage.proof.testimonial.quote}"
          </p>
          <cite class="text-sm font-medium text-accent-600 dark:text-accent-400 not-italic">
            — {homepage.proof.testimonial.attribution}
          </cite>
        </blockquote>
      )}
      <div class="mt-8 text-center">
        <a
          href={homepage.proof.cta.href}
          class="inline-flex items-center text-accent-600 dark:text-accent-400 font-medium hover:text-accent-700 dark:hover:text-accent-300"
        >
          {homepage.proof.cta.label}
          <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- How I Work Section -->
  <section class="py-16 md:py-24">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-neutral-900 dark:text-neutral-100 mb-8">
        {homepage.process.heading}
      </h2>
      <ol class="space-y-6 max-w-2xl">
        {homepage.process.steps.map((step) => (
          <li class="flex gap-4">
            <span class="flex-shrink-0 w-8 h-8 rounded-full bg-accent-100 dark:bg-accent-900 text-accent-600 dark:text-accent-400 flex items-center justify-center font-semibold text-sm">{step.number}</span>
            <div>
              <h3 class="font-semibold text-neutral-900 dark:text-neutral-100">{step.title}</h3>
              <p class="text-neutral-600 dark:text-neutral-400">{step.description}</p>
            </div>
          </li>
        ))}
      </ol>
      <p class="mt-8 text-neutral-600 dark:text-neutral-400 max-w-2xl">
        {homepage.process.closing}
      </p>
    </div>
  </section>

  <!-- About Teaser Section -->
  <section class="py-16 md:py-24 bg-neutral-100 dark:bg-neutral-900">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col md:flex-row gap-8 md:gap-12 items-start">
        <img
          src="/avatar.png"
          alt="MP"
          class="w-20 h-20 rounded-full bg-neutral-200 dark:bg-neutral-800 flex-shrink-0"
          onerror="this.style.display='none'"
        />
        <div>
          <h2 class="text-neutral-900 dark:text-neutral-100 mb-4">
            {homepage.about.heading}
          </h2>
          {homepage.about.paragraphs.map((para, i) => (
            <p class={`text-neutral-700 dark:text-neutral-300 ${i < homepage.about.paragraphs.length - 1 ? 'mb-4' : 'mb-6'}`}>
              {para}
            </p>
          ))}
          <a
            href={homepage.about.cta.href}
            class="inline-flex items-center text-accent-600 dark:text-accent-400 font-medium hover:text-accent-700 dark:hover:text-accent-300"
          >
            {homepage.about.cta.label}
            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Final CTA Section -->
  <section class="py-20 md:py-32">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-neutral-900 dark:text-neutral-100 mb-4">
        {homepage.finalCta.heading}
      </h2>
      <p class="text-lg text-neutral-600 dark:text-neutral-400 mb-8 max-w-xl mx-auto">
        {homepage.finalCta.subheading}
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a
          href={homepage.finalCta.primary.href}
          class="inline-flex items-center justify-center px-6 py-3 text-base font-medium rounded-lg bg-accent-600 text-white hover:bg-accent-700 transition-colors"
        >
          {homepage.finalCta.primary.label}
        </a>
        {site.email && (
          <a
            href={`mailto:${site.email}`}
            class="inline-flex items-center justify-center px-6 py-3 text-base font-medium rounded-lg border border-neutral-300 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors"
          >
            {homepage.finalCta.secondary.label}
          </a>
        )}
      </div>
    </div>
  </section>
</BaseLayout>
